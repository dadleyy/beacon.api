language: go

go:
  - 1.8

install:
  - wget https://github.com/google/protobuf/archive/v3.3.0.tar.gz
  - tar -xzvf v3.3.0.tar.gz
  - pushd protobuf-3.3.0 && ./autogen.sh && ./configure --prefix=/usr && make && sudo make install && popd
  - rm -rf protobuf-3.3.0
  - protoc --version
  - go get -u github.com/Masterminds/glide
  - go get -u github.com/golang/protobuf/protoc-gen-go
  - go get -u github.com/golang/lint/golint
  - glide install

script: 
  - touch .env
  - make
  - make lint
  - ./auto/travis/test.sh
  - go vet $(go list ./... | grep -vi 'vendor\|testing')

after_success:
  - bash <(curl -s https://codecov.io/bash)
